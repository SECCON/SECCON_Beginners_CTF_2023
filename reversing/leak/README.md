# Leak

## 問題文

サーバーから不審な通信を検出しました！

調査したところさらに不審なファイルを発見したので、通信記録と合わせて解析してください。

機密情報が流出してしまったかも...？

## 難易度

**Medium**

## 作問にあたって

`/tmp/flag`ファイルの内容を読み取り、少し変形させたRC4で暗号化した上で外部に送信するLinux ELFファイル

pcapファイルから該当する通信を見つけ、RC4の復号プログラムを書く

## 解法

stringsでRC4の鍵を見つける

```
$ strings leak
KEY{th1s_1s_n0t_f1ag_y0u_need_t0_f1nd_rea1_f1ag}
```

バイナリを解析すると`encrypt`関数がRC4による暗号化を行っていることがわかるが、少しSの生成に変更が加わっており、

```
S = [0, 1, 2, ...]
```

となるはずが

```
S = [53, 54, 55, ...]
```

と53ずれた状態で初期化されている。これを踏まえてpcapファイルから該当する通信を見つけhex streamでコピーし復号プログラムを書く

```
$ python solve.py
ctf4b{p4y_n0_4ttent10n_t0_t4at_m4n_beh1nd_t4e_cur4a1n}
```
